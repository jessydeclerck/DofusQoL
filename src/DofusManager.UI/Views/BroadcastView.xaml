<UserControl x:Class="DofusManager.UI.Views.BroadcastView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">

    <Grid Margin="10">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
        </Grid.RowDefinitions>

        <!-- Formulaire d'ajout de preset -->
        <GroupBox Grid.Row="0" Header="Nouveau preset" Margin="0,0,0,10" Padding="5">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto" />
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="Auto" />
                    <ColumnDefinition Width="*" />
                </Grid.ColumnDefinitions>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                </Grid.RowDefinitions>

                <!-- Ligne 1 : Nom + Type -->
                <TextBlock Grid.Row="0" Grid.Column="0" Text="Nom :" VerticalAlignment="Center" Margin="0,0,5,5" />
                <TextBox Grid.Row="0" Grid.Column="1" Text="{Binding PresetName, UpdateSourceTrigger=PropertyChanged}"
                         VerticalContentAlignment="Center" Margin="0,0,10,5" />
                <TextBlock Grid.Row="0" Grid.Column="2" Text="Type :" VerticalAlignment="Center" Margin="0,0,5,5" />
                <ComboBox Grid.Row="0" Grid.Column="3" ItemsSource="{Binding InputTypes}"
                          SelectedItem="{Binding SelectedInputType}" Margin="0,0,0,5" />

                <!-- Ligne 2 : Touche / Coordonnées -->
                <TextBlock Grid.Row="1" Grid.Column="0" Text="Touche :" VerticalAlignment="Center" Margin="0,0,5,5" />
                <TextBox Grid.Row="1" Grid.Column="1" Text="{Binding KeyName, UpdateSourceTrigger=PropertyChanged}"
                         VerticalContentAlignment="Center" Margin="0,0,10,5" />
                <TextBlock Grid.Row="1" Grid.Column="2" Text="Position :" VerticalAlignment="Center" Margin="0,0,5,5" />
                <StackPanel Grid.Row="1" Grid.Column="3" Orientation="Horizontal" Margin="0,0,0,5">
                    <TextBlock Text="X:" VerticalAlignment="Center" Margin="0,0,3,0" />
                    <TextBox Text="{Binding ClickX}" Width="50" Margin="0,0,5,0" VerticalContentAlignment="Center" />
                    <TextBlock Text="Y:" VerticalAlignment="Center" Margin="0,0,3,0" />
                    <TextBox Text="{Binding ClickY}" Width="50" VerticalContentAlignment="Center" />
                </StackPanel>

                <!-- Ligne 3 : Cibles + Ordre + Délais -->
                <TextBlock Grid.Row="2" Grid.Column="0" Text="Cibles :" VerticalAlignment="Center" Margin="0,0,5,5" />
                <ComboBox Grid.Row="2" Grid.Column="1" ItemsSource="{Binding TargetModes}"
                          SelectedItem="{Binding SelectedTargets}" Margin="0,0,10,5" />
                <TextBlock Grid.Row="2" Grid.Column="2" Text="Délai (ms) :" VerticalAlignment="Center" Margin="0,0,5,5" />
                <StackPanel Grid.Row="2" Grid.Column="3" Orientation="Horizontal" Margin="0,0,0,5">
                    <TextBox Text="{Binding DelayMin}" Width="50" Margin="0,0,5,0" VerticalContentAlignment="Center" />
                    <TextBlock Text="—" VerticalAlignment="Center" Margin="0,0,5,0" />
                    <TextBox Text="{Binding DelayMax}" Width="50" VerticalContentAlignment="Center" />
                </StackPanel>

                <!-- Ligne 4 : Ordre + Bouton ajouter -->
                <TextBlock Grid.Row="3" Grid.Column="0" Text="Ordre :" VerticalAlignment="Center" Margin="0,0,5,0" />
                <ComboBox Grid.Row="3" Grid.Column="1" ItemsSource="{Binding OrderModes}"
                          SelectedItem="{Binding SelectedOrderMode}" Margin="0,0,10,0" />
                <Button Grid.Row="3" Grid.Column="2" Grid.ColumnSpan="2"
                        Content="Ajouter le preset"
                        Command="{Binding AddPresetCommand}"
                        Padding="10,5" HorizontalAlignment="Right" />
            </Grid>
        </GroupBox>

        <!-- Liste des presets -->
        <GroupBox Grid.Row="1" Header="Presets de broadcast" Padding="5">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="Auto" />
                </Grid.ColumnDefinitions>

                <DataGrid Grid.Column="0"
                          ItemsSource="{Binding Presets}"
                          SelectedItem="{Binding SelectedPreset}"
                          AutoGenerateColumns="False"
                          IsReadOnly="True"
                          SelectionMode="Single"
                          GridLinesVisibility="Horizontal"
                          AlternatingRowBackground="#F5F5F5"
                          Margin="0,0,5,0">
                    <DataGrid.Columns>
                        <DataGridTextColumn Header="Nom" Binding="{Binding Name}" Width="*" />
                        <DataGridTextColumn Header="Type" Binding="{Binding InputType}" Width="100" />
                        <DataGridTextColumn Header="Description" Binding="{Binding Description}" Width="250" />
                    </DataGrid.Columns>
                </DataGrid>

                <StackPanel Grid.Column="1" VerticalAlignment="Center">
                    <Button Content="Tester"
                            Command="{Binding TestBroadcastCommand}"
                            Padding="10,5" Margin="0,0,0,5" />
                    <Button Content="Supprimer"
                            Command="{Binding RemovePresetCommand}"
                            Padding="10,5" Margin="0,0,0,5" />
                    <Button Content="{Binding PauseButtonText}"
                            Command="{Binding TogglePauseCommand}"
                            Padding="10,5" />
                </StackPanel>
            </Grid>
        </GroupBox>

        <!-- Push-to-Broadcast -->
        <GroupBox Grid.Row="2" Header="Push-to-Broadcast (Hold)" Margin="0,10,0,0" Padding="5">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto" />
                    <ColumnDefinition Width="Auto" />
                    <ColumnDefinition Width="*" />
                </Grid.ColumnDefinitions>

                <Button Grid.Column="0"
                        Content="{Binding PushToBroadcastButtonText}"
                        Command="{Binding TogglePushToBroadcastCommand}"
                        Padding="10,5" Margin="0,0,10,0" />

                <Border Grid.Column="1" CornerRadius="3" Padding="8,3">
                    <Border.Style>
                        <Style TargetType="Border">
                            <Setter Property="Background" Value="Gray" />
                            <Style.Triggers>
                                <DataTrigger Binding="{Binding IsArmed}" Value="True">
                                    <Setter Property="Background" Value="#E74C3C" />
                                </DataTrigger>
                            </Style.Triggers>
                        </Style>
                    </Border.Style>
                    <TextBlock Text="{Binding PushToBroadcastIndicator}"
                               FontWeight="Bold" Foreground="White" />
                </Border>

                <TextBlock Grid.Column="2" VerticalAlignment="Center" Margin="10,0,0,0"
                           Foreground="Gray" TextWrapping="Wrap"
                           Text="Activez puis maintenez Alt : chaque clic est broadcasté à toutes les fenêtres." />
            </Grid>
        </GroupBox>

        <!-- Info -->
        <TextBlock Grid.Row="3" Margin="0,10,0,0" Foreground="Gray" TextWrapping="Wrap"
                   Text="Les presets envoient un seul input (touche OU clic) vers les fenêtres Dofus sélectionnées, avec un délai aléatoire entre chaque envoi." />

        <!-- Statut -->
        <StatusBar Grid.Row="4" Margin="0,10,0,0">
            <StatusBarItem Content="{Binding StatusText}" />
        </StatusBar>
    </Grid>
</UserControl>
